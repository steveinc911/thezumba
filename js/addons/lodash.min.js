angular.module("jkuri.gallery",[]).directive("ngGallery",["$document","$timeout","$q","$templateCache",function(e,t,n,r){"use strict";function o(e,t){e.baseClass=e.class||i.baseClass,e.thumbClass=e.thumbClass||i.thumbClass,e.thumbsNum=e.thumbsNum||3}var i={baseClass:"ng-gallery",thumbClass:"ng-thumb",templateUrl:"ng-gallery.html"},s={enter:13,esc:27,left:37,right:39},u=i.templateUrl;return r.put(u,'<div class="{{ baseClass }}">  <div ng-repeat="i in images">    <img ng-src="{{ i.thumb }}" class="{{ thumbClass }}" ng-click="openGallery($index)" alt="Image {{ $index + 1 }}" />  </div></div><div class="ng-overlay" ng-show="opened"></div><div class="ng-gallery-content" ng-show="opened">  <div class="uil-ring-css" ng-show="loading"><div></div></div>  <a class="close-popup" ng-click="closeGallery()"><i class="fa fa-close"></i></a>  <a class="nav-left" ng-click="prevImage()"><i class="fa fa-angle-left"></i></a>  <img ng-src="{{ img }}" ng-click="nextImage()" ng-show="!loading" class="effect" />  <a class="nav-right" ng-click="nextImage()"><i class="fa fa-angle-right"></i></a>  <span class="info-text">{{ index + 1 }}/{{ images.length }} - {{ description }}</span>  <div class="ng-thumbnails-wrapper">    <div class="ng-thumbnails slide-left">      <div ng-repeat="i in images">        <img ng-src="{{ i.thumb }}" ng-class="{\'active\': index === $index}" ng-click="changeImage($index)" />      </div>    </div>  </div></div>'),{restrict:"EA",scope:{images:"=",thumbsNum:"@"},templateUrl:function(e,t){return t.templateUrl||i.templateUrl},link:function(r,i,u){o(r,u),r.thumbsNum>=11&&(r.thumbsNum=11);var a=e.find("body"),f=angular.element(document.querySelectorAll(".ng-thumbnails-wrapper")),l=angular.element(document.querySelectorAll(".ng-thumbnails"));r.index=0,r.opened=!1,r.thumb_wrapper_width=0,r.thumbs_width=0;var c=function(e){var t=n.defer(),i=new Image;return i.onload=function(){r.loading=!1,(typeof this.complete===!1||this.naturalWidth===0)&&t.reject(),t.resolve(i)},i.onerror=function(){t.reject()},i.src=r.images[e].img,r.loading=!0,t.promise},h=function(e){c(r.index).then(function(e){r.img=e.src,d(r.index)}),r.description=r.images[e].description||""};r.changeImage=function(e){r.index=e,c(r.index).then(function(e){r.img=e.src,d(r.index)})},r.nextImage=function(){r.index+=1,r.index===r.images.length&&(r.index=0),h(r.index)},r.prevImage=function(){r.index-=1,r.index<0&&(r.index=r.images.length-1),h(r.index)},r.openGallery=function(e){typeof e!==undefined&&(r.index=e,h(r.index)),r.opened=!0,t(function(){var e=p();r.thumbs_width=e.width,l.css({width:e.width+"px"}),f.css({width:e.visible_width+"px"}),d(r.index)})},r.closeGallery=function(){r.opened=!1},a.bind("keydown",function(e){if(!r.opened)return;var t=e.which;t===s.esc?r.closeGallery():t===s.right||t===s.enter?r.nextImage():t===s.left&&r.prevImage(),r.$apply()});var p=function(){var e=0,t=0;return angular.forEach(l.find("img"),function(n){e+=n.clientWidth,e+=10,t=n.clientWidth+10}),{width:e,visible_width:t*r.thumbsNum}},d=function(e){t(function(){var t=r.images.length,n=r.thumbs_width,i=f[0].scrollLeft,s=parseInt(n/t,10),o=e+1,u=Math.ceil(t/o);f[0].scrollLeft=0,f[0].scrollLeft=o*s-u*s},100)}}}}]);